(in-package #:incandescent)

(defvar *pointlight-pos* (v! 0 0 0))

(defparameter *light-pos* (v! 17.545997 12.553596 115.4780827))
(defparameter *light-color* (v! 0.78823537 0.8862746 1.0))

(defparameter *parallax-scale* .01f0)

;; http://planetpixelemporium.com/tutorialpages/light.html
;;  0 Candle           1900 255  147   41   (v! 1.0 0.5764706 0.16078432)
;;  1 40W Tungsten     2600 255  197  143   (v! 1.0 0.7725491 0.56078434)
;;  2 100W Tungsten    2850 255  214  170   (v! 1.0 0.83921576 0.6666667)
;;  3 Halogen          3200 255  241  224   (v! 1.0 0.9450981 0.87843144)
;;  4 Carbon Arc       5200 255  250  244   (v! 1.0 0.9803922 0.9568628)
;;  5 High Noon Sun    5400 255  255  251   (v! 1.0 1.0 0.9843138)
;;  6 Direct Sunlight  6000 255  255  255   (v! 1.0 1.0 1.0)
;;  7 Overcast Sky     7000 201  226  255   (v! 0.78823537 0.8862746 1.0)
;;  8 Clear Blue Sky  20000  64  156  255   (v! 0.2509804 0.6117647 1.0)
;;  9 Warm Fluorescent          255 244 229 (v! 1.0 0.9568628 0.8980393)
;; 10 Standard Fluorescent      244 255 250 (v! 0.9568628 1.0 0.9803922)
;; 11 Cool White Fluorescent    212 235 255 (v! 0.8313726 0.9215687 1.0)
;; 12 Full Spectrum Fluorescent 255 244 242 (v! 1.0 0.9568628 0.9490197)
;; 13 Grow Light Fluorescent    255 239 247 (v! 1.0 0.93725497 0.9686275)
;; 14 Black Light Fluorescent   167 0 255   (v! 0.654902 0.0 1.0)
;; 15 Mercury Vapor             216 247 255 (v! 0.8470589 0.9686275 1.0)
;; 16 Sodium Vapor              255 209 178 (v! 1.0 0.8196079 0.69803923)
;; 17 Metal Halide              242 252 255 (v! 0.9490197 0.98823535 1.0)
;; 18 High Pressure Sodium      255 183 76  (v! 1.0 0.7176471 0.29803923)
(defvar *sample-colors*
  (list (v! 1.0        0.5764706  0.16078432)
        (v! 1.0        0.7725491  0.56078434)
        (v! 1.0        0.83921576 0.6666667)
        (v! 1.0        0.9450981  0.87843144)
        (v! 1.0        0.9803922  0.9568628)
        (v! 1.0        1.0        0.9843138)
        (v! 1.0        1.0        1.0)
        (v! 0.78823537 0.8862746  1.0)
        (v! 0.2509804  0.6117647  1.0)
        (v! 1.0        0.9568628  0.8980393)
        (v! 0.9568628  1.0        0.9803922)
        (v! 0.8313726  0.9215687  1.0)
        (v! 1.0        0.9568628  0.9490197)
        (v! 1.0        0.93725497 0.9686275)
        (v! 0.654902   0.0        1.0)
        (v! 0.8470589  0.9686275  1.0)
        (v! 1.0        0.8196079  0.69803923)
        (v! 0.9490197  0.98823535 1.0)
        (v! 1.0        0.7176471  0.29803923))
  "Length=19")

(defparameter *light-color* (nth 2 *sample-colors*))

(defun render-all-the-things (actor camera time)
  (declare (single-float time))
  (update actor time)
  (draw actor camera time))

(defgeneric draw (actor camera time))
(defmethod draw :around (actor camera time)
  (when (slot-value actor 'draw-p)
    (call-next-method)))
(defmethod draw (actor camera time))
